<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FACTURA</title>
    <link rel="icon" href="https://github.com/rimedhn/demo/blob/main/Logo.png?raw=true" type="image/x-icon">
    <style type="text/css">
      #letter-size {
        width: 5.5in;
        margin: 0in;
        padding: 20px;
        font-family: Arial, sans-serif;
        margin-left: 0.2in;
        margin-right: 0.2in;
        margin-top: 0.5in;
        margin-bottom: 0.5in;
      }

      .label {
        text-align: center;
        font-size: 18px;
        margin-bottom: 10px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        word-break: break-word; /* Para direcciones largas de cliente */
        white-space: normal;
        overflow-wrap: break-word;
      }

      .sin-bordes {
      border-collapse: collapse;
      border: 0px;
      }
      
      table,
      th,
      td {
        border: 1px solid black;
        padding: 8px;
        word-break: break-word; /* Para direcciones largas de cliente */
        white-space: normal;
        overflow-wrap: break-word;
      }

      #detailhead .line1 {
        text-align: left;
        width: 50%;
      }

      .detail1 {
        text-align: right;
        width: 50%;
      }

      .Fact {
        text-align: left;
      }

      .listitem {
        font-size: 16px;
        text-align: left;
      }

      #listitemhead {
        font-size: 5px;
        text-align: center;
      }

      .descriptions {
        text-align: left;
      }

      .Price,
      .Desc,
      .Isv,
      .Amount {
        text-align: right;
      }

      #letter-size h2 {
        font-size: 22px;
        text-align: center;
        margin-bottom: 10px;
      }

      #letter-size .informasi {
        text-align: left;
        font-size: 16px;
        margin-bottom: 5px;
      }

      #letter-size .bawah {
        text-align: center;
        margin-top: 20px;
        font-size: 18px;
      }

      .mi-imagen {
        width: 100px;
        height: 100px;
        padding: auto;
        align: center;
        vertical-align: center;
      }
    </style>
  </head>
  <body>
    <div class="label">    
      <table style="width: 100%; border-collapse: collapse;
    border: none;" class="sin-bordes">
        <tr>
          <th colspan="3" style="width: 10%">
            <img src="https://github.com/rimedhn/demo/blob/main/Logo.png?raw=true" alt="Mi imagen" class="mi-imagen" />
          </th>
          <th colspan="9" style="width: 90%; text-align: left">
            <b style="font-size: 30px" id="empresa"></b><br />
            <b>RTN: <span id="rtn"></span></b><br />
            <b>Direccion: <span id="direccion"></span></b><br />
            <b>Telefono: <span id="telefono"></span></b><br />
            <b>Email: <span id="email"></span></b>
            <b id="razon"></b>
          </th>
        </tr>
      </table>

      <table style="width: 100%">
        <tr>
          <th colspan="12">
            <b><h2 ><span id="tipodoc"></span><span id="factura"></span></h2></b>
          </th>
        </tr>
        <tr>
          <th colspan="6" style="width: 50%; white-space: nowrap">
            Datos cliente
          </th>
          <th colspan="6" style="width: 50%; white-space: nowrap">
            Datos factura
          </th>
        </tr>
        <tr>
          <td colspan="6" style="width: 50%; white-space: nowrap; word-break: break-word; white-space: normal; overflow-wrap: break-word;">
            <div style="text-align: left">
              <b>Cliente: <span id="cliente"></span></b><br />
              <b>RTN: <span id="rtncliente"></span></b><br />
              <b>Telefono: <span id="telefonocliente"></span></b><br />
              <b>Direccion: <span id="direccioncliente"></span></b><br />
              <b>Vendedor: <span id="vendedor"></span></b><br />
            </div>
          </td>
          <td colspan="6" style="width: 50%;  white-space: nowrap; word-break: break-word; white-space: normal; overflow-wrap: break-word;">
            <div style="text-align: left">
              <b>Factura: <span id="factura"></span></b><br />
              <b>Fecha: <span id="date"></span></b><br />
              <b>CAI: <span id="cai"></span></b><br />
              <b>Rango autorizado: <span id="rango"></span></b><br />
              <b>Fecha limite de emision: <span id="limite"></span></b><br />
              <b>Cajero: <span id="cajero"></span></b><br />
            </div>
          </td>
        </tr>
      </table>

      <table style="width: 100%">
        <tr>
          <td style="text-align: center; class="detalleproducts" colspan="12">Detalle</td>
        </tr>
        <tr>
          <td  style="text-align: center; width: 10%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Referencia
            </h2>
          </td>
          <td  style="text-align: center; width: 10%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Cantidad
            </h2>
          </td>
          <td  style="text-align: right; width: 10%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Color
            </h2>
          </td>
          <td  style="text-align: right; width: 10%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Talla
            </h2>
          </td>
          <td  style="text-align: left; width: 30%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Descripci√≥n
            </h2>
          </td>
          <td  style="text-align: right; width: 10%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Marca
            </h2>
          </td>
          <td  style="text-align: right; width: 10%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Precio U.
            </h2>
          </td>
          <td  style="text-align: right; width: 10%">
            <h2 style="font-size: 4mm; text-align: Center; line-height: 0.1">
              Importe
            </h2>
          </td>
        </tr>
        <tbody id="productList"></tbody>
        <tr>
          <td
            colspan="4"
            style="
              border-top: 1px solid black;
              text-align: left;
              vertical-align: text-top;
            "
          >            
            <div align="left">
              --------------------------------------------------------------------------------------------------
            </div>
            Observaciones: <span id="observacion"></span>
            <div align="left">
              --------------------------------------------------------------------------------------------------
            </div>
            <b>Datos del cliente exonerado</b><br />
            <span>Orden de compra exenta: <b id="ocexe"></b></span>&nbsp;&nbsp;
            <span>No. Registro exonerado: <b id="ocexo"></b></span>&nbsp;&nbsp;
            <span>No. Registro SAG: <b id="nosag"></b></span>
           
            <div align="left">
              --------------------------------------------------------------------------------------------------
            </div>
            <b>Condiciones de pago</b><br />
            <span>Formado de pago: <b id="formapago"></b></span>
            <span>Plazo en dias: <b id="plazo"></b></span><br />
            <span>Cantidad de pagos: <b id="pagos"></b></span>
            <span
              >Cuota por pago: <b>L <span id="cuota"></span></b
            ></span>

          </td>
          <td
            colspan="2"
            style="
              white-space: nowrap;
              border-top: 1px solid black;
              text-align: right;
            "
          >
            Subtotal:<br />
            Descuentos y rebajas:<br />
            Valor exento:<br />
            Valor exonerado:<br />
            Gravado con 15%:<br />
            Gravado con 18%:<br />
            Isv 15%:<br />
            Isv 18%:<br />
            <b>Total venta:</b>
          </td>
          <td
            colspan="2"
            style="
              white-space: nowrap;
              border-top: 1px solid black;
              text-align: right;
            "
          >
            L<span id="subtotal"></span><br />
            L<span id="descuento"></span><br />
            L<span id="subtotalexe"></span><br />
            L<span id="subtotalexo"></span><br />
            L<span id="subtotalisv15"></span><br />
            L<span id="subtotalisv18"></span><br />
            L<span id="isv15"></span><br />
            L<span id="isv18"></span><br />
            <b>L<span id="total"></span></b>
          </td>
        </tr>
        <tr>
          <td
            colspan="12"
            style="
              white-space: nowrap;
              border-top: 1px solid black;
              text-align: center;
            "
          >
            MONTO EN LETRAS: <span id="montoLetras"></span>
          </td>
        </tr>
        <tr>
          <td
            colspan="12"
            style="
              white-space: nowrap;
              border-top: 1px solid black;
              text-align: center;
            "
          >
            <div>
              Gracias por su preferencia!!
              <br />
            </div>
          </td>
        </tr>
      </table>

      <table style="padding: 0; border: none; border-collapse: collapse">
        <tr style="border: none; border-collapse: collapse">
          <td
            colspan="3"
            style="
              text-align: left;
              vertical-align: top;
              border: none;
              border-collapse: collapse;
            "
          >
            <b>Original: cliente, Copia: emisor</b>
            <br /><span>www.rmposhn.com</span><br />
            <span>indime.hn@gmail.com</span>
            <span>(+504) 9359-3126</span>
          </td>
          <td
            colspan="3"
            style="white-space: nowrap; border: none; border-collapse: collapse"
          >
            <div style="text-align: right">
              <img alt="Barcode Generator TEC-IT" id="barcode" />
            </div>
          </td>
        </tr>
      </table>
    </div>

    <script>
      function getQueryParam(param) {
        var urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      function fillData() {
        document.getElementById("empresa").textContent =
          getQueryParam("empresa");
        document.getElementById("razon").textContent = getQueryParam("razon");
        document.getElementById("rtn").textContent = getQueryParam("rtn");
        document.getElementById("direccion").textContent =
          getQueryParam("direccion");
        document.getElementById("telefono").textContent =
          getQueryParam("telefono");
        document.getElementById("email").textContent = getQueryParam("email");
        document.getElementById("tipodoc").textContent =
          getQueryParam("tipodoc");
        document.getElementById("cliente").textContent =
          getQueryParam("cliente");
        document.getElementById("rtncliente").textContent =
          getQueryParam("rtncliente");
        document.getElementById("telefonocliente").textContent =
          getQueryParam("telefonocliente");
        document.getElementById("direccioncliente").textContent =
          getQueryParam("direccioncliente");
        document.getElementById("vendedor").textContent =
          getQueryParam("vendedor");
        document.getElementById("factura").textContent =
          getQueryParam("factura");
        document.getElementById("date").textContent = getQueryParam("date");
        document.getElementById("cai").textContent = getQueryParam("cai");
        document.getElementById("rango").textContent = getQueryParam("rango");
        document.getElementById("limite").textContent = getQueryParam("limite");
        document.getElementById("cajero").textContent = getQueryParam("cajero");
        document.getElementById("ocexe").textContent = getQueryParam("ocexe");
        document.getElementById("ocexo").textContent = getQueryParam("ocexo");
        document.getElementById("nosag").textContent = getQueryParam("nosag");
        document.getElementById("formapago").textContent = getQueryParam("formapago");
        document.getElementById("plazo").textContent = getQueryParam("plazo");
        document.getElementById("pagos").textContent = getQueryParam("pagos");
        document.getElementById("cuota").textContent = getQueryParam("cuota");
        document.getElementById("observacion").textContent = getQueryParam("observacion");
        document.getElementById("subtotal").textContent = getQueryParam("subtotal");
        document.getElementById("descuento").textContent = getQueryParam("descuento");
        document.getElementById("subtotalexe").textContent = getQueryParam("subtotalexe");
        document.getElementById("subtotalexo").textContent = getQueryParam("subtotalexo");
        document.getElementById("subtotalisv15").textContent = getQueryParam("subtotalisv15");
        document.getElementById("subtotalisv18").textContent = getQueryParam("subtotalisv18");
        document.getElementById("isv15").textContent = getQueryParam("isv15");
        document.getElementById("isv18").textContent = getQueryParam("isv18");
        document.getElementById("total").textContent = getQueryParam("total");

        // Set barcode
        document.getElementById("barcode").src =
          "https://barcode.tec-it.com/barcode.ashx?data=" +
          getQueryParam("Folio_1");

        // Fill product list
        var referencia = getQueryParam("referencia").split(",");
        var cantidad = getQueryParam("cantidad").split(",");
        var color = getQueryParam("color").split(",");
        var talla = getQueryParam("talla").split(",");
        var descripcion = getQueryParam("descripcion").split(",");
        var marca = getQueryParam("marca").split(",");
        var precio = getQueryParam("precio").split(",");
        var importe = getQueryParam("importe").split(",");

        var productList = document.getElementById("productList");
        for (var i = 0; i < descripcion.length; i++) {
          var row = productList.insertRow();
          row.insertCell(0).textContent = referencia[i];
          row.insertCell(1).textContent = cantidad[i];
          row.insertCell(2).textContent = color[i];
          row.insertCell(3).textContent = talla[i];
          row.insertCell(4).textContent = descripcion[i];
          row.insertCell(5).textContent = marca[i];
          row.insertCell(6).textContent = precio[i];
          row.insertCell(7).textContent = importe[i];
        }

        // Convert amount to words (simplified version)
        var total = parseFloat(getQueryParam("total"));
        var words = numberToWords(total);
        document.getElementById("montoLetras").textContent = words;
      }

      function numberToWords(number) {
        var units = [
          "",
          "UN ",
          "DOS ",
          "TRES ",
          "CUATRO ",
          "CINCO ",
          "SEIS ",
          "SIETE ",
          "OCHO ",
          "NUEVE ",
          "DIEZ ",
          "ONCE ",
          "DOCE ",
          "TRECE ",
          "CATORCE ",
          "QUINCE ",
          "DIECISEIS ",
          "DIECISIETE ",
          "DIECIOCHO ",
          "DIECINUEVE ",
        ];
        var tens = [
          "",
          "",
          "VEINTE ",
          "TREINTA ",
          "CUARENTA ",
          "CINCUENTA ",
          "SESENTA ",
          "SETENTA ",
          "OCHENTA ",
          "NOVENTA ",
        ];
        var hundreds = [
          "",
          "CIENTO ",
          "DOSCIENTOS ",
          "TRESCIENTOS ",
          "CUATROCIENTOS ",
          "QUINIENTOS ",
          "SEISCIENTOS ",
          "SETECIENTOS ",
          "OCHOCIENTOS ",
          "NOVECIENTOS ",
        ];
        var scales = ["", "MIL ", "MILLON ", "MIL MILLONES ", "BILLON "];

        if (number === 0) return "CERO LEMPIRAS";

        var words = "";
        var scaleIndex = 0;

        while (number > 0) {
          if (number % 1000 !== 0) {
            var scale = scales[scaleIndex];
            var partWords = numberToWordsLessThanThousand(number % 1000);

            // Special case for thousands
            if (scaleIndex === 1 && number % 1000 === 1) {
              words = scale + words;
            } else {
              words = partWords + scale + words;
            }
          }
          number = Math.floor(number / 1000);
          scaleIndex++;
        }

        return words.trim() + " LEMPIRAS";

        function numberToWordsLessThanThousand(n) {
          var words = "";

          if (n >= 100) {
            if (n === 100) {
              words += "CIEN ";
            } else {
              words += hundreds[Math.floor(n / 100)];
            }
            n %= 100;
          }

          if (n >= 20) {
            words += tens[Math.floor(n / 10)];
            if (n % 10 !== 0) {
              if (Math.floor(n / 10) === 2) {
                words = words.slice(0, -1); // Remove space for "VEINTI"
                words += "I";
              } else {
                words += "Y ";
              }
              words += units[n % 10];
            }
          } else if (n >= 1) {
            words += units[n];
          }

          return words;
        }
      }

      window.onload = function () {
        fillData();
        window.print();
      };
    </script>
  </body>
</html>
